<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CAS-LIF | ç”Ÿæ´»æ–¹å¼ä¸ä¸´åºŠè¯„ä¼°</title>
    <style>
        /* ç§‘æŠ€æ¸©æƒ…é£ UI */
        :root { --primary: #1e293b; --blue: #4f46e5; --light-blue: #eef2ff; --green: #10b981; --red: #f43f5e; --teal: #0d9488; --slate: #64748b; }
        body { font-family: -apple-system, sans-serif; background: #fcfcfd; margin: 0; padding: 20px; color: #334155; }
        .container { max-width: 750px; margin: 0 auto 30px; background: white; padding: 40px; border-radius: 24px; box-shadow: 0 10px 30px rgba(0,0,0,0.03); border: 1px solid #f1f5f9; }
        .hidden { display: none !important; }
        
        .module-header { border-left: 6px solid var(--teal); padding-left: 15px; margin-bottom: 30px; }
        .module-header h2 { margin: 0; font-size: 22px; color: var(--primary); }
        .module-header p { margin: 5px 0 0 0; color: var(--slate); font-size: 14px; }

        .sys-btn { width: 100%; padding: 18px; margin-bottom: 12px; border: none; border-radius: 16px; cursor: pointer; font-weight: bold; font-size: 15px; transition: 0.2s; display: flex; align-items: center; gap: 12px; }
        .btn-menu { background: #f0fdfa; color: #0f766e; border: 1px solid #ccfbf1; }
        .btn-menu:hover { background: var(--teal); color: white; transform: translateX(5px); box-shadow: 0 8px 15px rgba(13, 148, 136, 0.2); }
        .btn-action { background: var(--teal); color: white; justify-content: center; margin-top: 30px; }

        /* é—®å·ç³»ç»Ÿç²¾ç¾ UI */
        .q-group { margin-bottom: 35px; background: #f8fafc; padding: 25px; border-radius: 16px; border: 1px dashed #e2e8f0; }
        .q-group label { display: block; font-weight: 600; margin-bottom: 20px; font-size: 16px; color: var(--primary); line-height: 1.5; }
        
        /* ä¼˜åŒ–å•é€‰æŒ‰é’®çš„è§¦æ§ä½“éªŒ (é€‚è€åŒ–) */
        .radio-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .radio-option { display: flex; align-items: center; padding: 15px; background: white; border: 2px solid #e2e8f0; border-radius: 12px; cursor: pointer; transition: 0.2s; }
        .radio-option:active { transform: scale(0.98); }
        .radio-option input[type="radio"] { width: 20px; height: 20px; margin-right: 15px; accent-color: var(--teal); cursor: pointer; }
        .radio-option:has(input[type="radio"]:checked) { border-color: var(--teal); background: #f0fdfa; }

        /* æ»‘å— */
        input[type=range] { -webkit-appearance: none; width: 100%; height: 10px; background: #e2e8f0; border-radius: 5px; outline: none; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; width: 28px; height: 28px; background: white; border: 4px solid var(--teal); border-radius: 50%; cursor: pointer; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .labels { display: flex; justify-content: space-between; font-size: 13px; color: var(--slate); margin-top: 12px; font-weight: bold; }
    </style>
    <script src="cas-storage.js"></script>
</head>
<body>
    <button onclick="location.href='index.html'" style="background:none; border:none; color:var(--teal); font-weight:bold; cursor:pointer; font-size:16px; margin-bottom:20px;">â† è¿”å›æ§åˆ¶å°</button>

    <div class="container" id="menu">
        <div class="module-header">
            <h2>ğŸŒ™ ç”Ÿæ´»æ–¹å¼ä¸æ—¥å¸¸åŠŸèƒ½ (CAS-LIF)</h2>
            <p>åŒ…å«ä¸»è§‚è®¤çŸ¥è¡°é€€(SCD)ã€æ—¥å¸¸å·¥å…·æ€§åŠŸèƒ½(IADL)ã€ç¡çœ èŠ‚å¾‹ä¸æŠ‘éƒç­›æŸ¥ã€‚</p>
        </div>
        <button class="sys-btn btn-menu" onclick="show('scd-area')">ğŸ§  1. SCD-Q ä¸»è§‚è®¤çŸ¥ä¸‹é™é—®å·</button>
        <button class="sys-btn btn-menu" onclick="show('iadl-area')">ğŸ› ï¸ 2. IADL æ—¥å¸¸ç”Ÿæ´»èƒ½åŠ›é‡è¡¨</button>
        <button class="sys-btn btn-menu" onclick="show('sleep-area')">ğŸ’¤ 3. ç¡çœ ä¸ç”Ÿç‰©èŠ‚å¾‹ç‰¹å¾è¯„ä¼°</button>
        <button class="sys-btn btn-menu" onclick="show('phq-area')">ğŸŒ§ï¸ 4. PHQ-2 æŠ‘éƒæƒ…ç»ªç­›æŸ¥é‡è¡¨</button>
    </div>

    <div class="container hidden" id="scd-area">
        <div class="module-header"><h2>ä¸»è§‚è®¤çŸ¥ä¸‹é™ (SCD-Q)</h2>
        <p>ä¸´åºŠæ„ä¹‰: SCD æ˜¯é˜¿å°”èŒ¨æµ·é»˜ç—… (AD) ä¸´åºŠå‰æœŸçš„é‡è¦é¢„æµ‹æŒ‡æ ‡ã€‚</p></div>
        
        <div class="q-group">
            <label>1. ä¸ä¸€å¹´å‰ç›¸æ¯”ï¼Œæ‚¨æ˜¯å¦è§‰å¾—è‡ªå·±çš„è®°å¿†åŠ›æ­£åœ¨ä¸‹é™ï¼Ÿ</label>
            <div class="radio-grid">
                <label class="radio-option"><input type="radio" name="scd1" value="1"> æ˜¯ (Yes)</label>
                <label class="radio-option"><input type="radio" name="scd1" value="0"> å¦ (No)</label>
            </div>
        </div>
        
        <div class="q-group">
            <label>2. è¿™ç§è®°å¿†åŠ›ä¸‹é™çš„æƒ…å†µæ˜¯å¦è®©æ‚¨æ„Ÿåˆ°æ‹…å¿ƒæˆ–ç„¦è™‘ï¼Ÿ</label>
            <div class="radio-grid">
                <label class="radio-option"><input type="radio" name="scd2" value="1"> æ˜¯ (Yes)</label>
                <label class="radio-option"><input type="radio" name="scd2" value="0"> å¦ (No)</label>
            </div>
        </div>

        <button class="sys-btn btn-action" onclick="saveSCD()">ä¿å­˜ SCD æ•°æ®</button>
    </div>

    <div class="container hidden" id="iadl-area">
        <div class="module-header"><h2>å·¥å…·æ€§æ—¥å¸¸ç”Ÿæ´»èƒ½åŠ› (IADL)</h2>
        <p>ä¸´åºŠè¯Šæ–­é‰´åˆ«: IADL å—æŸæ˜¯åŒºåˆ† MCI (è½»åº¦è®¤çŸ¥éšœç¢) ä¸ç—´å‘† (Dementia) çš„æ ¸å¿ƒåˆ†æ°´å²­ã€‚</p></div>
        
        <div class="q-group">
            <label>1. ã€ç®¡ç†è´¢åŠ¡ã€‘: æ‚¨èƒ½ç‹¬ç«‹å¤„ç†è´¦å•ã€å»é“¶è¡ŒåŠç†ä¸šåŠ¡å—ï¼Ÿ</label>
            <div class="radio-grid">
                <label class="radio-option"><input type="radio" name="iadl1" value="0"> å®Œå…¨ç‹¬ç«‹</label>
                <label class="radio-option"><input type="radio" name="iadl1" value="1"> éœ€è¦éƒ¨åˆ†ååŠ©</label>
                <label class="radio-option" style="grid-column: 1 / -1;"><input type="radio" name="iadl1" value="2"> å®Œå…¨æ— æ³•ç‹¬ç«‹å®Œæˆ</label>
            </div>
        </div>
        
        <div class="q-group">
            <label>2. ã€æœè¯ç®¡ç†ã€‘: æ‚¨èƒ½æŒ‰æ—¶æŒ‰é‡ã€æ­£ç¡®åœ°æœç”¨è‡ªå·±çš„æ—¥å¸¸è¯ç‰©å—ï¼Ÿ</label>
            <div class="radio-grid">
                <label class="radio-option"><input type="radio" name="iadl2" value="0"> å®Œå…¨ç‹¬ç«‹</label>
                <label class="radio-option"><input type="radio" name="iadl2" value="1"> éœ€äººæé†’æˆ–å‡†å¤‡</label>
            </div>
        </div>

        <button class="sys-btn btn-action" onclick="saveIADL()">ä¿å­˜ IADL è¯„ä¼°</button>
    </div>

    <div class="container hidden" id="sleep-area">
        <div class="module-header"><h2>ç¡çœ ç»“æ„ä¸ç”Ÿç‰©èŠ‚å¾‹</h2>
        <p>ä¸´åºŠæ„ä¹‰: æ˜¼å¤œèŠ‚å¾‹ç´Šä¹± (Circadian Disruption) å’Œç¡çœ ç¢ç‰‡åŒ–å¾€å¾€æ—©äºè®¤çŸ¥è¡°é€€å‡ºç°ã€‚</p></div>
        
        <div class="q-group">
            <label>1. è¿‡å»ä¸€ä¸ªæœˆå†…ï¼Œæ‚¨å¹³å‡æ¯æ™šçš„ã€å®é™…ç¡çœ æ—¶é—´ã€‘å¤§çº¦æ˜¯ï¼Ÿ</label>
            <div style="font-weight:bold; color:var(--teal); text-align:center; font-size:24px; margin-bottom:15px;" id="sleep-hr-val">7 å°æ—¶</div>
            <input type="range" id="sleep-hr" min="2" max="14" step="0.5" value="7" oninput="document.getElementById('sleep-hr-val').innerText = this.value + ' å°æ—¶'">
        </div>
        
        <div class="q-group">
            <label>2. æ‚¨åœ¨ç¡çœ è¿‡ç¨‹ä¸­ï¼Œæ˜¯å¦ç»å¸¸å‡ºç°å¤§å£°åšæ¢¦ã€æŒ¥åŠ¨æ‰‹è‡‚æˆ–è¸¢è…¿çš„æƒ…å†µï¼Ÿ(RBD å¿«é€Ÿçœ¼åŠ¨æœŸç¡çœ è¡Œä¸ºéšœç¢ç­›æŸ¥)</label>
            <div class="radio-grid">
                <label class="radio-option"><input type="radio" name="sleep-rbd" value="1"> ç»å¸¸å‘ç”Ÿ</label>
                <label class="radio-option"><input type="radio" name="sleep-rbd" value="0"> ä»æœªå‘ç”Ÿ</label>
            </div>
        </div>

        <button class="sys-btn btn-action" onclick="saveSleep()">ä¿å­˜ç¡çœ ç‰¹å¾</button>
    </div>

    <div class="container hidden" id="phq-area">
        <div class="module-header"><h2>æŠ‘éƒæƒ…ç»ªç­›æŸ¥ (PHQ-2)</h2>
        <p>ä¸´åºŠæ„ä¹‰: æé«˜æ¯”ä¾‹çš„æ—©æœŸè®¤çŸ¥å‡é€€æ‚£è€…ä¼´éšæŠ‘éƒï¼Œå¿…é¡»æ’é™¤â€œæŠ‘éƒæ€§å‡æ€§ç—´å‘†â€ã€‚</p></div>
        
        <p style="color:var(--slate); font-weight:bold;">åœ¨è¿‡å»çš„ 2 å‘¨å†…ï¼Œæ‚¨å¤šé•¿é¢‘ç‡å—åˆ°ä»¥ä¸‹é—®é¢˜çš„å›°æ‰°ï¼Ÿ</p>

        <div class="q-group">
            <label>1. åšäº‹ç¼ºä¹å…´è¶£æˆ–ä¹è¶£ï¼Ÿ</label>
            <select id="phq1" style="width:100%; padding:15px; border-radius:12px; border:2px solid #e2e8f0; font-size:16px;">
                <option value="-1">è¯·é€‰æ‹©...</option>
                <option value="0">å®Œå…¨æ²¡æœ‰ (0åˆ†)</option>
                <option value="1">æœ‰å‡ å¤© (1åˆ†)</option>
                <option value="2">ä¸€åŠä»¥ä¸Šçš„å¤©æ•° (2åˆ†)</option>
                <option value="3">å‡ ä¹æ¯å¤© (3åˆ†)</option>
            </select>
        </div>
        
        <div class="q-group">
            <label>2. æ„Ÿåˆ°æƒ…ç»ªä½è½ã€æ²®ä¸§æˆ–ç»æœ›ï¼Ÿ</label>
            <select id="phq2" style="width:100%; padding:15px; border-radius:12px; border:2px solid #e2e8f0; font-size:16px;">
                <option value="-1">è¯·é€‰æ‹©...</option>
                <option value="0">å®Œå…¨æ²¡æœ‰ (0åˆ†)</option>
                <option value="1">æœ‰å‡ å¤© (1åˆ†)</option>
                <option value="2">ä¸€åŠä»¥ä¸Šçš„å¤©æ•° (2åˆ†)</option>
                <option value="3">å‡ ä¹æ¯å¤© (3åˆ†)</option>
            </select>
        </div>

        <button class="sys-btn btn-action" onclick="savePHQ()">è®¡ç®— PHQ å¾—åˆ†å¹¶ä¿å­˜</button>
    </div>

    <script>
        function show(id) {
            ['menu', 'scd-area', 'iadl-area', 'sleep-area', 'phq-area'].forEach(d => {
                const el = document.getElementById(d); if(el) el.classList.add('hidden');
            });
            document.getElementById(id).classList.remove('hidden'); window.scrollTo(0,0);
        }

        // è¾…åŠ©å‡½æ•°ï¼šè·å– Radio é€‰ä¸­çš„å€¼
        function getRadioVal(name) {
            const ele = document.getElementsByName(name);
            for(let i=0; i<ele.length; i++) { if(ele[i].checked) return parseInt(ele[i].value); }
            return null;
        }

        function saveSCD() {
            const q1 = getRadioVal('scd1'); const q2 = getRadioVal('scd2');
            if (q1 === null || q2 === null) return alert("è¯·å›ç­”æ‰€æœ‰é—®é¢˜ï¼");
            CAS_Storage.saveModuleData('Lifestyle_SCD', { memory_decline: q1, worry_about_decline: q2, scd_score: q1 + q2 });
            alert("SCD æ•°æ®å·²ä¿å­˜ï¼"); show('menu');
        }

        function saveIADL() {
            const q1 = getRadioVal('iadl1'); const q2 = getRadioVal('iadl2');
            if (q1 === null || q2 === null) return alert("è¯·å›ç­”æ‰€æœ‰é—®é¢˜ï¼");
            CAS_Storage.saveModuleData('Lifestyle_IADL', { finance_management: q1, medication_management: q2, iadl_impairment_score: q1 + q2 });
            alert("IADL æ•°æ®å·²ä¿å­˜ï¼"); show('menu');
        }

        function saveSleep() {
            const rbd = getRadioVal('sleep-rbd');
            if (rbd === null) return alert("è¯·å›ç­”æ‰€æœ‰é—®é¢˜ï¼");
            CAS_Storage.saveModuleData('Lifestyle_Sleep', { sleep_duration_hrs: parseFloat(document.getElementById('sleep-hr').value), rbd_symptom: rbd });
            alert("ç¡çœ èŠ‚å¾‹ç‰¹å¾å·²ä¿å­˜ï¼"); show('menu');
        }

        function savePHQ() {
            const p1 = parseInt(document.getElementById('phq1').value);
            const p2 = parseInt(document.getElementById('phq2').value);
            if (p1 === -1 || p2 === -1) return alert("è¯·é€‰æ‹©æ‚¨çš„å›°æ‰°é¢‘ç‡ï¼");
            
            const totalScore = p1 + p2;
            CAS_Storage.saveModuleData('Lifestyle_PHQ2', { q1: p1, q2: p2, total_score: totalScore });
            
            // ä¸´åºŠæç¤ºï¼šPHQ-2 å¾—åˆ† >= 3 æç¤ºå­˜åœ¨é‡å¤§æŠ‘éƒé£é™©ï¼Œéœ€è¿›ä¸€æ­¥è¿›è¡Œ PHQ-9 è¯„ä¼°
            let msg = `é‡è¡¨ä¿å­˜æˆåŠŸã€‚PHQ-2 æ€»åˆ†: ${totalScore} åˆ†ã€‚`;
            if (totalScore >= 3) msg += "\n\nâš ï¸ ä¸´åºŠæç¤ºï¼šå¾—åˆ†â‰¥3ï¼Œæç¤ºå¯èƒ½å­˜åœ¨æŠ‘éƒç—‡çŠ¶ï¼Œå»ºè®®æ’æŸ¥æŠ‘éƒæ€§å‡æ€§ç—´å‘†ã€‚";
            alert(msg); show('menu');
        }
    </script>
</body>
</html>
