<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CAS - å¤šæ¨¡æ€æ•°å­—è¡¨å‹è¯„ä¼°ç³»ç»Ÿ</title>
    <style>
        /* æ ¸å¿ƒè§†è§‰è§„èŒƒ */
        :root { 
            --primary: #0f172a; --blue: #3b82f6; --purple: #8b5cf6; --green: #10b981;
            --rose: #f43f5e; --amber: #f59e0b; --bg: #f8fafc; --text: #334155; --muted: #64748b; 
        }
        body { font-family: -apple-system, "PingFang SC", "Microsoft YaHei", sans-serif; background: var(--bg); margin: 0; padding: 20px; color: var(--text); }
        
        /* å¤´éƒ¨è£…é¥° */
        header { 
            text-align: center; margin-bottom: 30px; padding: 40px 20px; 
            background: white; border-radius: 20px; box-shadow: 0 4px 25px rgba(0,0,0,0.05); 
            border-top: 8px solid var(--primary); 
        }
        header h1 { margin: 0 0 10px 0; font-size: 28px; color: var(--primary); letter-spacing: 1px; }
        .eng-title { font-family: "SF Mono", monospace; color: var(--blue); font-size: 14px; font-weight: bold; text-transform: uppercase; }

        /* å»ºæ¡£è¡¨å•å¡ç‰‡ */
        #setup-container { 
            max-width: 750px; margin: 40px auto; background: white; padding: 45px; 
            border-radius: 24px; box-shadow: 0 15px 35px rgba(0,0,0,0.07); 
        }
        #setup-container h2 { margin-top: 0; color: var(--primary); font-size: 22px; border-left: 5px solid var(--blue); padding-left: 15px; margin-bottom: 30px; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-bottom: 25px; }
        .form-group label { display: block; font-weight: bold; font-size: 14px; margin-bottom: 10px; color: #475569; }
        .form-group input, .form-group select { 
            width: 100%; box-sizing: border-box; padding: 15px; border: 2px solid #e2e8f0; 
            border-radius: 12px; font-size: 16px; background: #fcfdfe; transition: 0.3s;
        }
        .form-group input:focus, .form-group select:focus { border-color: var(--blue); outline: none; background: white; box-shadow: 0 0 0 4px rgba(59,130,246,0.1); }
        .submit-btn { 
            width: 100%; padding: 20px; background: var(--blue); color: white; border: none; 
            border-radius: 14px; font-size: 18px; font-weight: bold; cursor: pointer; 
            transition: 0.3s; box-shadow: 0 8px 20px rgba(59,130,246,0.3); margin-top: 10px;
        }
        .submit-btn:hover { background: #2563eb; transform: translateY(-2px); }

        /* ä»ªè¡¨ç›˜æ ·å¼ */
        #dashboard-container { display: none; max-width: 1200px; margin: 0 auto; animation: fadeInUp 0.6s ease-out; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .subj-badge { 
            padding: 18px 25px; background: #eff6ff; color: #1e40af; border-radius: 15px; 
            display: flex; justify-content: space-between; align-items: center; 
            font-weight: bold; border: 1px solid #bfdbfe; margin-bottom: 30px;
        }

        /* å…­å¤§é¢†åŸŸç½‘æ ¼ */
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 25px; }
        .card { 
            background: white; padding: 30px; border-radius: 24px; transition: 0.3s; 
            display: flex; flex-direction: column; height: 100%; box-sizing: border-box; text-decoration: none; color: inherit;
            border: 1px solid #f1f5f9;
        }
        .card:hover { transform: translateY(-8px); box-shadow: 0 20px 30px rgba(0,0,0,0.08); }

        /* å½©è‰²é¡µæ ‡ */
        .card.cog { border-top: 6px solid var(--blue); } .card.emo { border-top: 6px solid var(--rose); }
        .card.mot { border-top: 6px solid var(--amber); } .card.sen { border-top: 6px solid #fbbf24; }
        .card.lan { border-top: 6px solid var(--purple); } .card.lif { border-top: 6px solid var(--green); }

        .card-header { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; } 
        .icon { font-size: 36px; }
        .card h2 { color: var(--primary); margin: 0; font-size: 20px; }
        .domain-desc { font-size: 14px; color: var(--muted); margin-bottom: 20px; line-height: 1.6; min-height: 40px; }
        
        .sub-test-list { list-style: none; padding: 0; margin: 0; flex-grow: 1; }
        .sub-test-list li { font-size: 15px; margin-bottom: 12px; display: flex; align-items: center; color: #475569; }
        .sub-test-list li::before { content: "â€¢"; font-size: 22px; margin-right: 12px; font-weight: bold; }
        .cog li::before { color: var(--blue); } .emo li::before { color: var(--rose); }
        .lan li::before { color: var(--purple); } .lif li::before { color: var(--green); }

        .card-action { 
            margin-top: 25px; padding: 15px; text-align: center; border-radius: 12px; font-weight: bold; 
            border: 2px dashed #e2e8f0; background: #f8fafc; transition: 0.2s; color: #64748b;
        }
        .card:hover .card-action { background: var(--primary); color: white; border-style: solid; border-color: var(--primary); }

        /* åº•éƒ¨æ“ä½œåŒº */
        .nav-footer { margin-top: 50px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .footer-btn { 
            display: flex; justify-content: center; align-items: center; gap: 10px; padding: 22px; 
            border-radius: 18px; text-decoration: none; font-weight: bold; font-size: 17px; transition: 0.3s;
        }
        .btn-manual { background: #f1f5f9; color: #475569; border: 1px solid #e2e8f0; }
        .btn-manual:hover { background: #e2e8f0; }
        .btn-report { background: var(--primary); color: white; box-shadow: 0 8px 20px rgba(15, 23, 42, 0.2); }
        .btn-report:hover { background: #000; transform: translateY(-3px); }
    </style>
    <script src="cas-storage.js"></script>
</head>
<body>

    <header>
        <h1>è®¡ç®—ç¥ç»å¿ƒç†ä¸æ•°å­—è¡¨å‹è¯„ä¼°ç³»ç»Ÿ (CAS)</h1>
        <div class="eng-title">Computational Assessment Suite for Digital Phenotyping</div>
    </header>

    <div id="setup-container">
        <h2>ğŸ“ å—è¯•è€…åŸºçº¿ä¿¡æ¯å½•å…¥</h2>
        <div class="form-row">
            <div class="form-group"><label>è¢«è¯•ç¼–å· (Subject ID) *</label><input type="text" id="subj-id" placeholder="å¦‚ï¼šCAS_2026_001"></div>
            <div class="form-group"><label>å§“åç¼©å†™ (Initial) *</label><input type="text" id="subj-name" placeholder="å¦‚ï¼šLY"></div>
        </div>
        <div class="form-row">
            <div class="form-group"><label>å‡ºç”Ÿæ—¥æœŸ *</label><input type="date" id="subj-dob"></div>
            <div class="form-group"><label>æ€§åˆ« *</label><select id="subj-gender"><option value="">è¯·é€‰æ‹©...</option><option value="Male">ç”·</option><option value="Female">å¥³</option></select></div>
        </div>
        <div class="form-row">
            <div class="form-group"><label>åˆ©æ‰‹ (Handedness) *</label><select id="subj-hand"><option value="">è¯·é€‰æ‹©...</option><option value="Right">å³æ‰‹</option><option value="Left">å·¦æ‰‹</option><option value="Ambi">åŒåˆ©æ‰‹</option></select></div>
            <div class="form-group">
                <label>æ•™è‚²æ°´å¹³ (Education) *</label>
                <select id="subj-edu">
                    <option value="">è¯·é€‰æ‹©...</option>
                    <option value="Primary">å°å­¦åŠä»¥ä¸‹</option>
                    <option value="Middle">åˆä¸­</option>
                    <option value="High">é«˜ä¸­/ä¸­ä¸“</option>
                    <option value="Bachelor">æœ¬ç§‘/å¤§ä¸“</option>
                    <option value="Master">ç¡•å£«åŠä»¥ä¸Š</option>
                </select>
            </div>
        </div>
        <button class="submit-btn" onclick="registerSubject()">âœ“ å¼€å¯æ•°å­—åŒ–è¯„ä¼°ä¼šè¯</button>
    </div>

    <div id="dashboard-container">
        <div class="subj-badge">
            <span>å½“å‰ä¼šè¯: <span id="display-subj-name"></span> [ID: <span id="display-subj-id"></span>]</span>
            <button onclick="CAS_Storage.clearSession()" style="background:#fff; border:1px solid #f43f5e; color:#f43f5e; padding:6px 15px; border-radius:10px; cursor:pointer; font-weight:bold;">æ¸…é™¤ä¼šè¯</button>
        </div>

        <div class="grid">
            <a href="cognition.html" class="card cog"><div class="card-header"><span class="icon">ğŸ§ </span><h2>è®¤çŸ¥ (COG)</h2></div><p class="domain-desc">é«˜çº§æ‰§è¡ŒåŠŸèƒ½ã€å·¥ä½œè®°å¿†ä¸åŠ å·¥é€Ÿåº¦ã€‚</p><ul class="sub-test-list"><li>Corsi ç©ºé—´è·¨åº¦è®°å¿†</li><li>Stroop è‰²è¯å¹²æ‰°æ§åˆ¶</li><li>DSST æ•°å­—ç¬¦å·åŒ¹é…</li></ul><div class="card-action">è¿›å…¥ è®¤çŸ¥ åŸŸæµ‹è¯• â”</div></a>
            <a href="emotion.html" class="card emo"><div class="card-header"><span class="icon">â¤ï¸</span><h2>æƒ…æ„Ÿ (EMO)</h2></div><p class="domain-desc">ç¬æ—¶æƒ…ç»ªçŠ¶æ€ã€äººæ ¼ç‰¹è´¨ä¸å†³ç­–å€¾å‘ã€‚</p><ul class="sub-test-list"><li>EMA ç¬æ—¶çŠ¶æ€è¯„ä¼°</li><li>BART æ°”çƒé£é™©å†³ç­–</li><li>E-Stroop æ³¨æ„åå‘æå–</li></ul><div class="card-action">è¿›å…¥ æƒ…æ„Ÿ åŸŸæµ‹è¯• â”</div></a>
            <a href="motor.html" class="card mot"><div class="card-header"><span class="icon">ğŸ¯</span><h2>è¿åŠ¨ (MOT)</h2></div><p class="domain-desc">ç²¾ç»†è¿åŠ¨æ§åˆ¶ã€åè°ƒæ€§ä¸éœ‡é¢¤åˆ†æã€‚</p><ul class="sub-test-list"><li>Tapping æ•²å‡»é¢‘ç‡æµ‹è¯•</li><li>Fitts è¿åŠ¨é¶å‘åè°ƒ</li><li>Spiral èºæ—‹çº¿è½¨è¿¹åˆ†æ</li></ul><div class="card-action">è¿›å…¥ è¿åŠ¨ åŸŸæµ‹è¯• â”</div></a>
            <a href="sensation.html" class="card sen"><div class="card-header"><span class="icon">âš¡</span><h2>æ„Ÿè§‰ (SEN)</h2></div><p class="domain-desc">åº•å±‚ååº”æ—¶åŸºçº¿ä¸çŸ¥è§‰æœç´¢èƒ½åŠ›ã€‚</p><ul class="sub-test-list"><li>RT ç®€å•/é€‰æ‹©ååº”æ—¶</li><li>Go/No-Go å†²åŠ¨æŠ‘åˆ¶</li><li>Visual Search ç‰¹å¾æœç´¢</li></ul><div class="card-action">è¿›å…¥ æ„Ÿè§‰ åŸŸæµ‹è¯• â”</div></a>
            <a href="language.html" class="card lan"><div class="card-header"><span class="icon">ğŸ’¬</span><h2>è¯­è¨€ (LAN)</h2></div><p class="domain-desc">è¯­ä¹‰æ£€ç´¢æ•ˆç‡ä¸è¯­ä¹‰ç½‘ç»œè¿é€šæ€§ã€‚</p><ul class="sub-test-list"><li>VFT è¯æ±‡æµç•…æ€§æå–</li><li>Naming æ•°å­—åŒ–å›¾ç‰‡å‘½å</li><li>Semantic è¯­ä¹‰å…³è”åˆ¤åˆ«</li></ul><div class="card-action">è¿›å…¥ è¯­è¨€ åŸŸæµ‹è¯• â”</div></a>
            <a href="lifestyle.html" class="card lif"><div class="card-header"><span class="icon">ğŸŒ™</span><h2>ç”Ÿæ´» (LIF)</h2></div><p class="domain-desc">æ—¥å¸¸åŠŸèƒ½è¯„ä¼°ä¸ç”Ÿç‰©èŠ‚å¾‹è´¨æ§ã€‚</p><ul class="sub-test-list"><li>SCD-Q ä¸»è§‚ä¸‹é™è‡ªè¯„</li><li>Sleep ç”Ÿç‰©èŠ‚å¾‹ä¸è´¨é‡</li><li>IADL/PHQ ç»¼åˆç­›æŸ¥</li></ul><div class="card-action">è¿›å…¥ ç”Ÿæ´» åŸŸæµ‹è¯• â”</div></a>
        </div>
        
        <div class="nav-footer">
            <a href="manual.html" class="footer-btn btn-manual">ğŸ“– äº¤äº’æŒ‡å—ä¸æ‰‹å†Œ</a>
            <a href="report.html" class="footer-btn btn-report">ğŸ“Š æ•°æ®ä¸­å¿ƒä¸å¯¼å‡º</a>
        </div>
    </div>

    <script>
        window.onload = function() {
            // é”å®šæ—¥æœŸä¸Šé™
            const today = new Date().toISOString().split("T")[0];
            document.getElementById('subj-dob').setAttribute("max", today);

            // æ£€æŸ¥ç°æœ‰ä¼šè¯
            if (CAS_Storage.hasSession()) {
                initDashboard();
            }
        };

        function initDashboard() {
            document.getElementById('setup-container').style.display = 'none'; 
            document.getElementById('dashboard-container').style.display = 'block';
            const session = CAS_Storage.getSession();
            document.getElementById('display-subj-name').innerText = session.demographics.name || "Anonymous"; 
            document.getElementById('display-subj-id').innerText = session.demographics.subject_id || "N/A";
        }

        function registerSubject() {
            const fields = ['subj-id', 'subj-name', 'subj-dob', 'subj-gender', 'subj-hand', 'subj-edu'];
            let data = {};
            for(let f of fields) {
                const val = document.getElementById(f).value;
                if(!val) return alert("âš ï¸ è¯·å®Œæ•´å¡«å†™å¸¦ * å·çš„å¿…å¡«é¡¹ï¼");
                data[f.replace('subj-', '')] = val;
            }
            
            CAS_Storage.initSession(data);
            initDashboard();
            window.scrollTo(0,0);
        }
    </script>
</body>
</html>
