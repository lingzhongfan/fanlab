<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CAS - å¤šæ¨¡æ€æ•°å­—è¡¨å‹è¯„ä¼°ç³»ç»Ÿ</title>
    <style>
        /* ç§‘æŠ€æ¸©æƒ…é£ (Warm-Tech UI) */
        :root { 
            --primary: #1e293b; --blue: #4f46e5; --light-blue: #eef2ff;
            --purple: #8b5cf6; --green: #10b981; --rose: #f43f5e; 
            --bg: #fcfcfd; --card-bg: #ffffff; --text: #334155; --muted: #64748b; 
        }
        body { font-family: "PingFang SC", "Microsoft YaHei", sans-serif; background: var(--bg); margin: 0; padding: 20px; color: var(--text); }
        
        header { 
            text-align: center; margin-bottom: 30px; padding: 40px 20px; 
            background: var(--card-bg); border-radius: 24px; 
            box-shadow: 0 10px 40px rgba(79, 70, 229, 0.05); border-top: 6px solid var(--blue); 
        }
        header h1 { margin: 0 0 10px 0; font-size: 26px; color: var(--primary); font-weight: 800; }
        .eng-title { font-family: monospace; color: var(--blue); font-size: 14px; opacity: 0.8; }

        #setup-container { 
            max-width: 750px; margin: 0 auto; background: var(--card-bg); padding: 45px; 
            border-radius: 24px; box-shadow: 0 10px 30px rgba(0,0,0,0.03); border: 1px solid #f1f5f9;
        }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px; }
        .form-group label { display: block; font-weight: 600; font-size: 14.5px; margin-bottom: 10px; color: #475569; }
        .form-group input, .form-group select { 
            width: 100%; box-sizing: border-box; padding: 16px; border: 2px solid #e2e8f0; 
            border-radius: 14px; font-size: 16px; background: #f8fafc; transition: 0.3s; color: var(--primary);
        }
        .form-group input:focus, .form-group select:focus { border-color: var(--blue); background: white; outline: none; box-shadow: 0 0 0 4px var(--light-blue); }
        
        .btn-main { 
            width: 100%; padding: 20px; background: var(--blue); color: white; border: none; 
            border-radius: 16px; font-size: 18px; font-weight: bold; cursor: pointer; 
            transition: 0.3s; box-shadow: 0 8px 20px rgba(79, 70, 229, 0.25); margin-top: 10px;
        }
        .btn-main:hover { transform: translateY(-3px); box-shadow: 0 12px 25px rgba(79, 70, 229, 0.35); }

        #dashboard-container { display: none; max-width: 1200px; margin: 0 auto; animation: fadeUp 0.6s ease; }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .subj-badge { 
            padding: 20px 30px; background: var(--light-blue); color: var(--blue); border-radius: 18px; 
            display: flex; justify-content: space-between; align-items: center; font-weight: bold; margin-bottom: 30px;
        }

        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 25px; }
        .card { 
            background: white; padding: 30px; border-radius: 24px; transition: 0.3s; 
            display: flex; flex-direction: column; text-decoration: none; color: inherit; border: 1px solid #f1f5f9;
        }
        .card:hover { transform: translateY(-8px); box-shadow: 0 20px 40px rgba(0,0,0,0.06); }
        
        .card-header { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; }
        .icon { font-size: 38px; background: #f8fafc; padding: 15px; border-radius: 20px; }
        .card h2 { margin: 0; font-size: 20px; color: var(--primary); }
        .domain-desc { font-size: 14px; color: var(--muted); margin-bottom: 20px; line-height: 1.6; }
        
        .sub-test-list { list-style: none; padding: 0; margin: 0; flex-grow: 1; }
        .sub-test-list li { font-size: 15px; margin-bottom: 12px; display: flex; align-items: center; color: #475569; font-weight: 500;}
        .sub-test-list li::before { content: "â€¢"; font-size: 24px; margin-right: 12px; color: var(--blue); }

        .card-action { 
            margin-top: 25px; padding: 16px; text-align: center; border-radius: 14px; font-weight: bold; 
            background: #f8fafc; color: var(--muted); transition: 0.3s;
        }
        .card:hover .card-action { background: var(--blue); color: white; }
    </style>
    <script src="cas-storage.js"></script>
</head>
<body>

    <header>
        <h1>è®¡ç®—ç¥ç»å¿ƒç†ä¸æ•°å­—è¡¨å‹è¯„ä¼°ç³»ç»Ÿ (CAS)</h1>
        <div class="eng-title">Computational Assessment Suite for Digital Phenotyping</div>
    </header>

    <div id="setup-container">
        <h2>ğŸ“ å—è¯•è€…å»ºæ¡£ (ç¤¾åŒºç­›æŸ¥ç‰ˆ)</h2>
        <div class="form-row">
            <div class="form-group"><label>è¢«è¯•ç¼–å· ID *</label><input type="text" id="subj-id" placeholder="å¦‚: CAS_001"></div>
            <div class="form-group"><label>å§“åç¼©å†™ *</label><input type="text" id="subj-name" placeholder="å¦‚: ZS"></div>
        </div>
        <div class="form-row">
            <div class="form-group"><label>å‡ºç”Ÿæ—¥æœŸ *</label><input type="date" id="subj-dob"></div>
            <div class="form-group"><label>æ€§åˆ« *</label><select id="subj-gender"><option value="">é€‰æ‹©</option><option value="Male">ç”·</option><option value="Female">å¥³</option></select></div>
        </div>
        <div class="form-row">
            <div class="form-group"><label>åˆ©æ‰‹ (Handedness) *</label><select id="subj-hand"><option value="">é€‰æ‹©</option><option value="Right">å³æ‰‹</option><option value="Left">å·¦æ‰‹</option><option value="Ambi">åŒåˆ©æ‰‹</option></select></div>
            <div class="form-group">
                <label>æ•™è‚²æ°´å¹³ (Education) *</label>
                <select id="subj-edu">
                    <option value="">é€‰æ‹©</option>
                    <option value="Primary">å°å­¦åŠä»¥ä¸‹ (â‰¤6å¹´)</option>
                    <option value="Middle">åˆä¸­ (9å¹´)</option>
                    <option value="High">é«˜ä¸­/ä¸­ä¸“ (12å¹´)</option>
                    <option value="Bachelor">æœ¬ç§‘/å¤§ä¸“ (16å¹´)</option>
                    <option value="Master">ç ”ç©¶ç”ŸåŠä»¥ä¸Š</option>
                </select>
            </div>
        </div>
        <button class="btn-main" onclick="registerSubject()">è¿›å…¥è¯„ä¼°é¢æ¿ â”</button>
    </div>

    <div id="dashboard-container">
        <div class="subj-badge">
            <span>ğŸ‘¤ å½“å‰ä¼šè¯: <span id="display-subj-name"></span> | ID: <span id="display-subj-id"></span></span>
            <button onclick="CAS_Storage.clearSession()" style="background:white; border:none; color:var(--rose); padding:8px 16px; border-radius:12px; font-weight:bold; cursor:pointer;">ç»“æŸä¼šè¯</button>
        </div>

        <div class="grid">
            <a href="cognition.html" class="card"><div class="card-header"><div class="icon">ğŸ§ </div><h2>è®¤çŸ¥ (COG)</h2></div><p class="domain-desc">é«˜çº§æ‰§è¡ŒåŠŸèƒ½ã€å·¥ä½œè®°å¿†ä¸å¤šé‡åŠ å·¥é€Ÿåº¦è¯„ä¼°ã€‚</p><ul class="sub-test-list"><li>Corsi ç©ºé—´è·¨åº¦è®°å¿†</li><li>Stroop è‰²è¯å¹²æ‰°æ§åˆ¶</li><li>DSST æ•°å­—ç¬¦å·åŒ¹é…</li></ul><div class="card-action">å¯åŠ¨æµ‹è¯•</div></a>
            <a href="emotion.html" class="card"><div class="card-header"><div class="icon">â¤ï¸</div><h2>æƒ…æ„Ÿ (EMO)</h2></div><p class="domain-desc">å¤šç»´åº¦çŠ¶æ€è‡ªè¯„ã€äººæ ¼ç‰¹è´¨è®¡ç®—ä¸é£é™©å†³ç­–åå¥½ã€‚</p><ul class="sub-test-list"><li>EMA 4ç»´åº¦ç¬æ—¶çŠ¶æ€</li><li>Big5 å¤§äº”äººæ ¼ç”»åƒ</li><li>BART æ°”çƒé£é™©å†³ç­–</li></ul><div class="card-action">å¯åŠ¨æµ‹è¯•</div></a>
            <a href="motor.html" class="card"><div class="card-header"><div class="icon">ğŸ¯</div><h2>è¿åŠ¨ (MOT)</h2></div><p class="domain-desc">ç²¾ç»†è¿åŠ¨æ§åˆ¶ã€ç©ºé—´åè°ƒæ€§ä¸å¾®å¼±éœ‡é¢¤åˆ†æã€‚</p><ul class="sub-test-list"><li>Tapping æ•²å‡»é¢‘ç‡æµ‹è¯•</li><li>Fitts è¿åŠ¨é¶å‘åè°ƒ</li><li>Spiral èºæ—‹çº¿è½¨è¿¹åˆ†æ</li></ul><div class="card-action">å¯åŠ¨æµ‹è¯•</div></a>
            <a href="sensation.html" class="card"><div class="card-header"><div class="icon">âš¡</div><h2>æ„Ÿè§‰ (SEN)</h2></div><p class="domain-desc">åº•å±‚ç¥ç»ååº”æ—¶åŸºçº¿ä¸é«˜é˜¶çŸ¥è§‰æœç´¢èƒ½åŠ›ã€‚</p><ul class="sub-test-list"><li>RT ç®€å•/é€‰æ‹©ååº”æ—¶</li><li>Go/No-Go å†²åŠ¨æŠ‘åˆ¶</li><li>Visual Search ç‰¹å¾æœç´¢</li></ul><div class="card-action">å¯åŠ¨æµ‹è¯•</div></a>
            <a href="language.html" class="card"><div class="card-header"><div class="icon">ğŸ’¬</div><h2>è¯­è¨€ (LAN)</h2></div><p class="domain-desc">ç»“åˆè¯­éŸ³è¯†åˆ«çš„è¯­ä¹‰æ£€ç´¢æ•ˆç‡ä¸ç½‘ç»œè¿é€šæ€§æµ‹è¯•ã€‚</p><ul class="sub-test-list"><li>VFT è¯­éŸ³æµåˆ©æ€§æå–</li><li>Naming æ•°å­—åŒ–å›¾ç‰‡å‘½å</li><li>Semantic è¯­ä¹‰å…³è”åˆ¤åˆ«</li></ul><div class="card-action">å¯åŠ¨æµ‹è¯•</div></a>
            <a href="lifestyle.html" class="card"><div class="card-header"><div class="icon">ğŸŒ™</div><h2>ç”Ÿæ´» (LIF)</h2></div><p class="domain-desc">ä¸»è§‚è¡°é€€æŒ‡æ ‡ã€æ—¥å¸¸ç‹¬ç«‹åŠŸèƒ½é‰´åˆ«ä¸æŠ‘éƒç­›æŸ¥ã€‚</p><ul class="sub-test-list"><li>SCD-Q ä¸»è§‚ä¸‹é™è‡ªè¯„</li><li>IADL å·¥å…·æ€§æ—¥å¸¸èƒ½åŠ›</li><li>PHQ-2 æŠ‘éƒé‰´åˆ«ç­›æŸ¥</li></ul><div class="card-action">å¯åŠ¨æµ‹è¯•</div></a>
        </div>
        
        <button onclick="location.href='report.html'" class="btn-main" style="max-width: 1200px; margin: 40px auto; display: block; padding: 25px; border-radius: 20px;">ğŸ“Š è¿›å…¥ä¸´åºŠæ•°æ®ä¸­å¿ƒ (å¯¼å‡º JSON æ•°æ®é›†)</button>
    </div>

    <script>
        window.onload = function() {
            document.getElementById('subj-dob').setAttribute("max", new Date().toISOString().split("T")[0]);
            if (CAS_Storage.hasSession()) {
                document.getElementById('setup-container').style.display = 'none'; 
                document.getElementById('dashboard-container').style.display = 'block';
                const session = CAS_Storage.getSession();
                document.getElementById('display-subj-name').innerText = session.demographics.name; 
                document.getElementById('display-subj-id').innerText = session.demographics.subject_id;
            }
        };

        function registerSubject() {
            const data = {
                subject_id: document.getElementById('subj-id').value,
                name: document.getElementById('subj-name').value,
                dob: document.getElementById('subj-dob').value,
                gender: document.getElementById('subj-gender').value,
                handedness: document.getElementById('subj-hand').value, // å®Œç¾æ•è·
                education_level: document.getElementById('subj-edu').value // å®Œç¾æ•è·
            };
            if(!data.subject_id || !data.dob || !data.education_level) return alert("âš ï¸ è¯·å®Œæ•´å¡«å†™ä¿¡æ¯");
            CAS_Storage.initSession(data);
            location.reload();
        }
    </script>
</body>
</html>
