<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAS - å¤šæ¨¡æ€æ•°å­—è¡¨å‹è¯„ä¼°ç³»ç»Ÿ</title>
    <style>
        :root { --primary: #1e293b; --blue: #4f46e5; --light-blue: #eef2ff; --bg: #fcfcfd; --text: #334155; }
        body { font-family: "PingFang SC", sans-serif; background: var(--bg); margin: 0; padding: 20px; color: var(--text); }
        
        header { text-align: center; margin-bottom: 30px; padding: 40px 20px; background: white; border-radius: 24px; box-shadow: 0 10px 40px rgba(79, 70, 229, 0.05); border-top: 6px solid var(--blue); }
        header h1 { margin: 0 0 10px 0; font-size: 26px; color: var(--primary); }
        .eng-title { font-family: monospace; color: var(--blue); font-size: 14px; opacity: 0.8; }

        /* å»ºæ¡£è¡¨å• */
        #setup-container { max-width: 750px; margin: 0 auto; background: white; padding: 45px; border-radius: 24px; box-shadow: 0 10px 30px rgba(0,0,0,0.03); border: 1px solid #f1f5f9; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px; }
        .form-group label { display: block; font-weight: bold; margin-bottom: 10px; color: #475569; }
        .form-group input, .form-group select { width: 100%; box-sizing: border-box; padding: 16px; border: 2px solid #e2e8f0; border-radius: 14px; font-size: 16px; background: #f8fafc; outline: none; transition: 0.3s; }
        .form-group input:focus, .form-group select:focus { border-color: var(--blue); background: white; box-shadow: 0 0 0 4px var(--light-blue); }
        .btn-main { width: 100%; padding: 20px; background: var(--blue); color: white; border: none; border-radius: 16px; font-size: 18px; font-weight: bold; cursor: pointer; transition: 0.3s; box-shadow: 0 8px 20px rgba(79, 70, 229, 0.25); }
        .btn-main:hover { transform: translateY(-3px); box-shadow: 0 12px 25px rgba(79, 70, 229, 0.35); }

        #dashboard-container { display: none; max-width: 1200px; margin: 0 auto; animation: fadeUp 0.6s ease; }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* æ‰¾å›çš„æ•™ç¨‹æ¨¡å— */
        .tutorial-container { background: white; border-radius: 20px; display: flex; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.02); border: 1px solid #e2e8f0; margin-bottom: 30px; }
        .manual-section { flex: 1.5; padding: 30px; background: #f8fafc; border-right: 1px solid #e2e8f0; }
        .anim-section { flex: 1; padding: 30px; display: flex; justify-content: space-around; align-items: center; background: white; }
        .tutorial-step { text-align: center; font-size: 14px; font-weight: bold; color: var(--primary); }
        .anim-box { width: 60px; height: 60px; margin: 0 auto 10px; background: var(--light-blue); border-radius: 12px; display: flex; align-items: center; justify-content: center; position: relative; }
        .anim-cursor { position: absolute; font-size: 20px; animation: click 2s infinite; }
        @keyframes click { 0% { transform: scale(1); } 50% { transform: scale(0.8); } 100% { transform: scale(1); } }

        .subj-badge { padding: 20px 30px; background: var(--light-blue); color: var(--blue); border-radius: 18px; display: flex; justify-content: space-between; align-items: center; font-weight: bold; margin-bottom: 30px; }

        /* å…­å¤§é¢æ¿ */
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 25px; margin-bottom: 40px; }
        .card { background: white; padding: 30px; border-radius: 24px; transition: 0.3s; display: flex; flex-direction: column; text-decoration: none; color: inherit; border: 1px solid #f1f5f9; }
        .card:hover { transform: translateY(-8px); box-shadow: 0 20px 40px rgba(0,0,0,0.06); }
        .card-header { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; }
        .icon { font-size: 38px; background: #f8fafc; padding: 15px; border-radius: 20px; }
        .card h2 { margin: 0; font-size: 20px; color: var(--primary); }
        .sub-test-list { list-style: none; padding: 0; margin: 0; flex-grow: 1; }
        .sub-test-list li { font-size: 15px; margin-bottom: 12px; font-weight: 500;}
        .sub-test-list li::before { content: "â€¢"; font-size: 24px; margin-right: 12px; color: var(--blue); }
        .card-action { margin-top: 25px; padding: 16px; text-align: center; border-radius: 14px; font-weight: bold; background: #f8fafc; color: #64748b; transition: 0.3s; border: 2px dashed #e2e8f0;}
        .card:hover .card-action { background: var(--blue); color: white; border-style: solid; }
        
        .footer-nav { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    </style>
    <script src="cas-storage.js"></script>
</head>
<body>
    <header><h1>è®¡ç®—ç¥ç»å¿ƒç†ä¸æ•°å­—è¡¨å‹è¯„ä¼°ç³»ç»Ÿ (CAS)</h1><div class="eng-title">Computational Assessment Suite</div></header>

    <div id="setup-container">
        <h2>ğŸ“ å—è¯•è€…å»ºæ¡£ (ä¸´åºŠç‰ˆ)</h2>
        <div class="form-row">
            <div class="form-group"><label>è¢«è¯•ç¼–å· ID *</label><input type="text" id="subj-id"></div>
            <div class="form-group"><label>å§“åç¼©å†™ *</label><input type="text" id="subj-name"></div>
        </div>
        <div class="form-row">
            <div class="form-group"><label>å‡ºç”Ÿæ—¥æœŸ *</label><input type="date" id="subj-dob"></div>
            <div class="form-group"><label>æ€§åˆ« *</label><select id="subj-gender"><option value="">é€‰æ‹©</option><option value="Male">ç”·</option><option value="Female">å¥³</option></select></div>
        </div>
        <div class="form-row">
            <div class="form-group"><label>åˆ©æ‰‹ (Handedness) *</label><select id="subj-hand"><option value="">é€‰æ‹©</option><option value="Right">å³æ‰‹</option><option value="Left">å·¦æ‰‹</option></select></div>
            <div class="form-group"><label>æ•™è‚²æ°´å¹³ (Education) *</label><select id="subj-edu"><option value="">é€‰æ‹©</option><option value="Primary">å°å­¦åŠä»¥ä¸‹</option><option value="Middle">åˆä¸­</option><option value="High">é«˜ä¸­/ä¸­ä¸“</option><option value="Bachelor">æœ¬ç§‘/å¤§ä¸“</option><option value="Master">ç ”ç©¶ç”ŸåŠä»¥ä¸Š</option></select></div>
        </div>
        <button class="btn-main" onclick="registerSubject()">è¿›å…¥è¯„ä¼°é¢æ¿ â”</button>
    </div>

    <div id="dashboard-container">
        <div class="tutorial-container">
            <div class="manual-section">
                <h3 style="margin-top:0; color:var(--primary);">ğŸ“‹ ä¸´åºŠä¸»è¯•æ“ä½œæ‰‹å†Œ</h3>
                <p style="color:#64748b; font-size: 14px; line-height: 1.6;">1. è¯·ä½¿ç”¨è§¦æ§å±è®¾å¤‡ï¼ˆæ¨ªå±æ˜¾ç¤ºï¼‰ã€‚<br>2. ä»»åŠ¡æ— å¼ºåˆ¶é¡ºåºï¼Œç‚¹å‡»ä¸‹æ–¹æ¨¡å—è¿›å…¥å³å¯ã€‚<br>3. å®Œæˆæ‰€æœ‰ 22 é¡¹æµ‹è¯•åï¼Œé€šè¿‡åº•éƒ¨è¿›å…¥æ•°æ®ä¸­å¿ƒå¯¼å‡ºã€‚</p>
            </div>
            <div class="anim-section">
                <div class="tutorial-step"><div class="anim-box"><div class="anim-cursor">ğŸ‘†</div></div>1. è¿›å…¥é¢æ¿</div>
                <div class="tutorial-step"><div class="anim-box" style="background:#dbeafe;"><span style="font-size:30px;">âœ“</span></div>2. å¼•å¯¼äº¤äº’</div>
                <div class="tutorial-step"><div class="anim-box" style="background:#e0e7ff;"><span style="font-size:30px;">ğŸ“Š</span></div>3. å¯¼å‡ºç»“æœ</div>
            </div>
        </div>

        <div class="subj-badge">
            <span>ğŸ‘¤ å½“å‰ä¼šè¯: <span id="display-subj-name"></span> | ID: <span id="display-subj-id"></span></span>
            <button onclick="CAS_Storage.clearSession()" style="background:white; border:none; color:#f43f5e; padding:8px 16px; border-radius:12px; font-weight:bold; cursor:pointer;">ç»“æŸä¼šè¯</button>
        </div>

        <div class="grid">
            <a href="cognition.html" class="card"><div class="card-header"><div class="icon">ğŸ§ </div><h2>è®¤çŸ¥ (COG)</h2></div><ul class="sub-test-list"><li>Corsi ç©ºé—´è·¨åº¦è®°å¿†</li><li>Stroop è‰²è¯å¹²æ‰°æ§åˆ¶</li><li>DSST æ•°å­—ç¬¦å·åŒ¹é…</li></ul><div class="card-action">å¯åŠ¨æµ‹è¯•</div></a>
            <a href="emotion.html" class="card"><div class="card-header"><div class="icon">â¤ï¸</div><h2>æƒ…æ„Ÿ (EMO)</h2></div><ul class="sub-test-list"><li>EMA 4ç»´åº¦ç¬æ—¶çŠ¶æ€</li><li>Big5 å¤§äº”äººæ ¼ç”»åƒ</li><li>BART æ°”çƒé£é™©å†³ç­–</li></ul><div class="card-action">å¯åŠ¨æµ‹è¯•</div></a>
            <a href="motor.html" class="card"><div class="card-header"><div class="icon">ğŸ¯</div><h2>è¿åŠ¨ (MOT)</h2></div><ul class="sub-test-list"><li>Tapping æ•²å‡»é¢‘ç‡æµ‹è¯•</li><li>Fitts è¿åŠ¨é¶å‘åè°ƒ</li><li>Spiral èºæ—‹çº¿è½¨è¿¹åˆ†æ</li></ul><div class="card-action">å¯åŠ¨æµ‹è¯•</div></a>
            <a href="sensation.html" class="card"><div class="card-header"><div class="icon">âš¡</div><h2>æ„Ÿè§‰ (SEN)</h2></div><ul class="sub-test-list"><li>RT ç®€å•/é€‰æ‹©ååº”æ—¶</li><li>Go/No-Go å†²åŠ¨æŠ‘åˆ¶</li><li>Visual Search ç‰¹å¾æœç´¢</li></ul><div class="card-action">å¯åŠ¨æµ‹è¯•</div></a>
            <a href="language.html" class="card"><div class="card-header"><div class="icon">ğŸ’¬</div><h2>è¯­è¨€ (LAN)</h2></div><ul class="sub-test-list"><li>VFT è¯­éŸ³æµåˆ©æ€§æå–</li><li>Naming æ•°å­—åŒ–å›¾ç‰‡å‘½å</li><li>Semantic è¯­ä¹‰å…³è”åˆ¤åˆ«</li></ul><div class="card-action">å¯åŠ¨æµ‹è¯•</div></a>
            <a href="lifestyle.html" class="card"><div class="card-header"><div class="icon">ğŸŒ™</div><h2>ç”Ÿæ´» (LIF)</h2></div><ul class="sub-test-list"><li>SCD-Q ä¸»è§‚ä¸‹é™è‡ªè¯„</li><li>IADL å·¥å…·æ€§æ—¥å¸¸èƒ½åŠ›</li><li>PHQ-2 æŠ‘éƒé‰´åˆ«ç­›æŸ¥</li></ul><div class="card-action">å¯åŠ¨æµ‹è¯•</div></a>
        </div>
        
        <div class="footer-nav">
            <a href="manual.html" class="btn-main" style="background:#f1f5f9; color:#475569; text-align:center; text-decoration:none; box-shadow:none;">ğŸ“– è¯¦å°½èŒƒå¼åŠ¨ç”»æ‰‹å†Œ</a>
            <a href="report.html" class="btn-main" style="text-align:center; text-decoration:none;">ğŸ“Š è¿›å…¥ä¸´åºŠæ•°æ®ä¸­å¿ƒ (è§£æä¸å¯¼å‡º)</a>
        </div>
    </div>

    <script>
        window.onload = function() {
            document.getElementById('subj-dob').setAttribute("max", new Date().toISOString().split("T")[0]);
            if (CAS_Storage.hasSession()) {
                document.getElementById('setup-container').style.display = 'none'; 
                document.getElementById('dashboard-container').style.display = 'block';
                const session = CAS_Storage.getSession();
                document.getElementById('display-subj-name').innerText = session.demographics.name; 
                document.getElementById('display-subj-id').innerText = session.demographics.subject_id;
            }
        };

        function registerSubject() {
            const data = {
                subject_id: document.getElementById('subj-id').value, name: document.getElementById('subj-name').value,
                dob: document.getElementById('subj-dob').value, gender: document.getElementById('subj-gender').value,
                handedness: document.getElementById('subj-hand').value, education_level: document.getElementById('subj-edu').value 
            };
            if(!data.subject_id || !data.dob || !data.education_level) return alert("âš ï¸ è¯·å®Œæ•´å¡«å†™ä¿¡æ¯");
            CAS_Storage.initSession(data); location.reload();
        }
    </script>
</body>
</html>
